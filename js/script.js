document.addEventListener("DOMContentLoaded",(function(){document.querySelector(".faq-container");const e=document.querySelectorAll(".accordeon"),t=document.querySelector(".faq");let o,n=null;function s(t=null){e.forEach((e=>{e!==t&&i(e)}))}function i(e){const t=e.querySelector(".acc-body"),o=e.querySelector(".acc-head"),s=e.querySelector(".acc-head img");if(!t||!s)return;t._animationFrame&&cancelAnimationFrame(t._animationFrame);const i=t.offsetHeight;t.style.height=i+"px",t.offsetHeight,t.style.height="0",t.style.padding="0 90px 0 30px",t.style.opacity="0",s.style.transform="rotate(0deg)",s.style.filter="none",s.style.opacity="1",o.classList.remove("open"),e.classList.remove("open"),setTimeout((()=>{"0px"===t.style.height&&(t.style.display="none")}),200),n===e&&(n=null)}function r(e){const o=e.querySelector(".acc-body"),i=e.querySelector(".acc-head"),r=e.querySelector(".acc-head img");if(!o||!r)return;o._animationFrame&&cancelAnimationFrame(o._animationFrame),s(e),o.style.display="block",o.style.height="auto",o.style.padding="10px 90px 10px 30px";const a=o.scrollHeight;o.style.height="0",o.style.padding="0 90px 0 30px",o.style.opacity="0",o.offsetHeight,o.style.height=a+"px",o.style.padding="10px 90px 10px 30px",o.style.opacity="1",r.style.transform="rotate(180deg)",r.style.filter="brightness(0.2)",r.style.opacity="0.5",i.classList.add("open"),e.classList.add("open"),n=e,setTimeout((()=>{const o=e.getBoundingClientRect(),n=window.innerHeight,s=document.querySelector("footer");if(o.bottom>n-100){const t=e.offsetTop-50;window.scrollTo({top:t,behavior:"smooth"})}if(s){const e=s.getBoundingClientRect();o.bottom>e.top&&e.top<n&&(t.style.paddingBottom="100px")}}),250)}function a(e){const t=e.querySelector(".acc-body");if(!t)return;"block"===t.style.display&&"0px"!==t.style.height&&parseFloat(t.style.height)>0?i(e):r(e)}e.forEach((e=>{const t=e.querySelector(".acc-body"),o=e.querySelector(".acc-head"),n=e.querySelector(".acc-head img");if(t){const e=t.innerHTML;t.setAttribute("data-content",e),t.style.display="none",t.style.height="0",t.style.overflow="hidden",t.style.transition="height 0.2s ease-out, padding 0.2s ease-out, opacity 0.2s ease-out",t.style.opacity="0",t.style.boxSizing="border-box"}n&&(n.style.transition="transform 0.2s ease-out, filter 0.2s ease-out, opacity 0.2s ease-out",n.style.cursor="pointer"),o&&(o.style.cursor="pointer",o.style.transition="background-color 0.2s ease",o.addEventListener("mouseenter",(function(){this.classList.contains("open")||(this.style.backgroundColor="rgba(0, 119, 255, 0.02)")})),o.addEventListener("mouseleave",(function(){this.style.backgroundColor=""}))),o&&o.addEventListener("click",(function(t){t.stopPropagation(),a(e)})),n&&n.addEventListener("click",(function(t){t.stopPropagation(),a(e)}))})),document.addEventListener("click",(function(e){if(!n)return;n.contains(e.target)||i(n)})),document.addEventListener("keydown",(function(e){"Escape"===e.key&&n&&i(n)})),window.addEventListener("resize",(function(){clearTimeout(o),o=setTimeout((function(){if(n){const e=n.querySelector(".acc-body");if(e&&"block"===e.style.display&&parseFloat(e.style.height)>0){e.style.height="auto",e.style.padding="10px 90px 10px 30px";const t=e.scrollHeight;e.style.height=t+"px"}}}),150)})),window.openFaqByIndex=function(t){t>=0&&t<e.length&&r(e[t])},window.closeAllFaq=function(){s()},console.log("FAQ аккордеон инициализирован")})),document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector(".registration-form"),t=document.querySelectorAll(".form-field");e.querySelector('button[type="submit"]');let o=new Map;function n(e,t,o=""){e.classList.remove("state-waiting","state-input","state-error","state-filled");e.querySelector("input"),e.querySelector(".input-wrapper"),e.querySelector(".field-label");const n=e.querySelector(".field-caption");e.classList.add(`state-${t}`),n&&("error"===t?(n.textContent=o||"Поле заполнено некорректно",n.style.opacity="1"):"waiting"===t?(n.textContent=n.getAttribute("data-original")||n.textContent||" ",n.style.opacity="0"):("input"===t||"filled"===t)&&(n.style.opacity="0"))}function s(e){const t=e.querySelector("input");if(!t)return!0;const o=t.id,n=t.value.trim();if(""===n)return{isValid:!1,message:"Поле обязательно для заполнения"};switch(o){case"name":case"lastname":case"city":if(!/^[A-Za-zА-Яа-яЁё\s-]+$/.test(n))return{isValid:!1,message:"Только буквы, пробелы и дефисы"};break;case"email":if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n))return{isValid:!1,message:"Введите корректный email"}}return{isValid:!0}}t.forEach((e=>{const t=e.querySelector("input"),s=e.querySelector(".input-wrapper"),i=e.querySelector(".field-label"),r=e.querySelector(".field-caption");o.set(e,{originalClasses:e.className,hasError:!1,isFilled:!1}),e.style.transition="all 0.3s ease",s&&(s.style.transition="border-color 0.3s ease"),t&&(t.style.transition="opacity 0.3s ease"),i&&(i.style.transition="display 0.3s ease, opacity 0.3s ease, padding 0.3s ease"),r&&(r.style.transition="display 0.3s ease, opacity 0.3s ease, color 0.3s ease"),n(e,"waiting")})),t.forEach((e=>{const i=e.querySelector("input");i&&(i.addEventListener("focus",(function(){t.forEach((t=>{if(t!==e&&!t.classList.contains("state-filled")){const e=t.querySelector("input");e&&!e.value.trim()&&n(t,"waiting")}})),n(e,"input")})),i.addEventListener("input",(function(){this.value.trim()&&n(e,"input")})),i.addEventListener("blur",(function(){if(this.value.trim()){const t=s(e);t.isValid?(n(e,"filled"),o.get(e).isFilled=!0,o.get(e).hasError=!1):(n(e,"error",t.message),o.get(e).hasError=!0,o.get(e).isFilled=!1)}else n(e,"waiting"),o.get(e).isFilled=!1,o.get(e).hasError=!1})))}));const i=document.querySelectorAll('input[name="track"]');function r(){Array.from(i).some((e=>e.checked))}function a(){for(let e of i)if(e.checked)return e.value;return null}i.forEach((e=>{e.addEventListener("change",(function(e){if(this.checked){i.forEach((e=>{e!==this&&e.checked&&(e.checked=!1)}));this.closest("label")}r()}))})),r(),e.addEventListener("submit",(function(e){e.preventDefault();let r=!1,c=null;t.forEach((e=>{const t=e.querySelector("input");if(!t)return;if(t.value.trim()){const t=s(e);t.isValid?(n(e,"filled"),o.get(e).hasError=!1,o.get(e).isFilled=!0):(n(e,"error",t.message),r=!0,o.get(e).hasError=!0,c||(c=e))}else n(e,"error","Поле обязательно для заполнения"),r=!0,o.get(e).hasError=!0,c||(c=e)}));if(!Array.from(i).some((e=>e.checked))){const e=document.querySelector(".choice");e&&(e.style.color="var(--red)",setTimeout((()=>{e.style.animation="",e.style.color=""}),300)),alert("Пожалуйста, выберите трек"),r=!0}r?c&&c.scrollIntoView({behavior:"smooth",block:"center"}):(console.log("Форма успешно заполнена"),console.log("Выбранный трек:",a()),function(){const e=document.createElement("div");e.className="success-message";const t="design"===a()?"Дизайн-трек":"Трек Разработка";e.textContent=`Заявка успешно отправлена! Вы выбрали: ${t}`,e.style.cssText="\n            position: fixed;\n            top: 50%;\n            left: 50%;\n            transform: translate(-50%, -50%);\n            background-color: var(--white);\n            color: var(--black);\n            padding: 30px 40px;\n            border-radius: 16px;\n            font-size: 24px;\n            line-height: 30px;\n            font-family: 'VkSans', sans-serif;\n            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n            z-index: 1000;\n            opacity: 0;\n            transition: opacity 0.3s ease;\n            text-align: center;\n            min-width: 300px;\n        ",document.body.appendChild(e),requestAnimationFrame((()=>{e.style.opacity="1"})),setTimeout((()=>{e.style.opacity="0",setTimeout((()=>{document.body.removeChild(e)}),300)}),3e3)}())})),window.resetForm=function(){e.reset(),t.forEach((e=>{n(e,"waiting"),o.get(e).hasError=!1,o.get(e).isFilled=!1})),i.forEach((e=>{e.checked=!1;const t=e.closest("label");t&&(t.style.color="",t.style.transform="")})),r()},setTimeout((()=>{t.forEach((e=>{e.style.opacity="1"}))}),100)}));